{"remainingRequest":"E:\\aproject\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\aproject\\vue-admin-template\\src\\views\\index\\photo\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\aproject\\vue-admin-template\\src\\views\\index\\photo\\index.vue","mtime":1682429509865},{"path":"E:\\aproject\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1680534835386},{"path":"E:\\aproject\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js","mtime":1680534836652},{"path":"E:\\aproject\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1680534835386},{"path":"E:\\aproject\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js","mtime":1680534837350}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBkZXZpY2VNaXhpbiBmcm9tICdAL21peGlucy9kZXZpY2UnCmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSAnQC91dGlscy9hdXRoJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdQaG90bycsCiAgbWl4aW5zOiBbZGV2aWNlTWl4aW5dLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkaWFsb2dJbWc6IHt9LAogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgaW1nbGlzdDogW10sCiAgICAgIHRva2VuOiAnJwogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMudG9rZW4gPSBnZXRUb2tlbigpCiAgfSwKICBtZXRob2RzOiB7CiAgICBoYW5kbGVSZW1vdmU6IGZ1bmN0aW9uKGZpbGUsIGZpbGVMaXN0KSB7CiAgICB9LAogICAgaGFuZGxlUGljdHVyZUNhcmRQcmV2aWV3KGZpbGUpIHsKICAgICAgdGhpcy5kaWFsb2dJbWcgPSBmaWxlCiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWUKICAgIH0sCiAgICBoYW5kbGVTdWNjZXNzKHJlcywgZmlsZSwgZmlsZWxpc3QpIHsKICAgICAgcmVzLnVybCA9ICcvZGV2LWFwaScgKyByZXMudXJsCiAgICAgIHRoaXMuaW1nbGlzdC5wdXNoKHJlcykKICAgICAgY29uc29sZS5sb2codGhpcy5pbWdsaXN0KQogICAgfSwKICAgIG9wZW5JbWcoKSB7CiAgICAgIHdpbmRvdy5vcGVuKHRoaXMuZGlhbG9nSW1nLnVybCkKICAgIH0sCiAgICBjbGVhck1vZGVsKCkgewogICAgICB0aGlzLiRyZWZzLnVwbG9hZC5jbGVhckZpbGVzKCkKICAgICAgdGhpcy5pbWdsaXN0ID0gW10KICAgIH0sCiAgICBkb3duTG9hZE1vZGVsKCkgewogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuaW1nbGlzdC5sZW5ndGg7IGkrKykgewogICAgICAgIGNvbnN0IHVybG5hbWUgPSB0aGlzLmltZ2xpc3RbaV0udXJsLnNwbGl0KCcvJykKICAgICAgICBjb25zdCBmaWxlbmFtZSA9IHVybG5hbWVbdXJsbmFtZS5sZW5ndGggLSAxXQogICAgICAgIGNvbnN0IHVybCA9ICdodHRwOi8vMTI3LjAuMC4xOjMwMDEnICsgdGhpcy5pbWdsaXN0W2ldLnVybC5zcGxpdChwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfQVBJKS5qb2luKCcnKQogICAgICAgIHRoaXMuZG93bmxvYWRQaWModXJsLCBmaWxlbmFtZSkKICAgICAgfQogICAgfSwKICAgIC8qIOWbvueJh+eahOS4i+i9vSovCiAgICBkb3dubG9hZFBpYyh1cmwsIGZpbGVuYW1lKSB7CiAgICAgIGNvbnN0IGltZ3NyYyA9IHVybAogICAgICBjb25zdCBpbWFnZSA9IG5ldyBJbWFnZSgpCiAgICAgIC8vIOino+WGs+i3qOWfn2NhbnZhc+axoeafk+mXrumimAogICAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoJ2Nyb3NzT3JpZ2luJywgJ2Fub255bW91cycpCiAgICAgIGltYWdlLm9ubG9hZCA9IGZ1bmN0aW9uKCkgewogICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpCiAgICAgICAgY2FudmFzLndpZHRoID0gaW1hZ2Uud2lkdGgKICAgICAgICBjYW52YXMuaGVpZ2h0ID0gaW1hZ2UuaGVpZ2h0CiAgICAgICAgY29uc3QgY29udGV4dCA9IGNhbnZhcy5nZXRDb250ZXh0KCcyZCcpCiAgICAgICAgY29udGV4dC5kcmF3SW1hZ2UoaW1hZ2UsIDAsIDAsIGltYWdlLndpZHRoLCBpbWFnZS5oZWlnaHQpCiAgICAgICAgY29uc3QgdXJsID0gY2FudmFzLnRvRGF0YVVSTCgnaW1hZ2UvcG5nJykgLy8g5b6X5Yiw5Zu+54mH55qEYmFzZTY057yW56CB5pWw5o2uCiAgICAgICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKQogICAgICAgIGEuZG93bmxvYWQgPSBmaWxlbmFtZQogICAgICAgIGEuaHJlZiA9IHVybAogICAgICAgIGEuY2xpY2soKQogICAgICB9CiAgICAgIGltYWdlLnNyYyA9IGltZ3NyYwogICAgfQoKICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"index.vue","sourceRoot":"src/views/index/photo","sourcesContent":["<template>\n  <div>\n    <div class=\"original_img\">\n      <el-upload\n        ref=\"upload\"\n        action=\"/dev-api/uploadimg\"\n        list-type=\"picture-card\"\n        multiple\n        :limit=\"8\"\n        :on-preview=\"handlePictureCardPreview\"\n        :on-remove=\"handleRemove\"\n        :on-success=\"handleSuccess\"\n      >\n        <i class=\"el-icon-plus\" />\n      </el-upload>\n      <el-dialog v-if=\"dialogVisible\" :visible.sync=\"dialogVisible\">\n        <img width=\"100%\" :src=\"dialogImg.url\" alt=\"\" title=\"点击在新窗口预览\" @click=\"openImg\">\n        <div><b>纬度：</b>{{ dialogImg.propties.Latitude }}</div>\n        <div><b>经度：</b>{{ dialogImg.propties.Longitude }}</div>\n        <div><b>详细地址：</b>{{ dialogImg.propties.Address[0] }}</div>\n        <div><b>拍摄时间：</b>{{ dialogImg.propties.Time_taken }}</div>\n      </el-dialog>\n    </div>\n\n    <div class=\"buttons\" style=\"height: 40px\">\n      <el-button type=\"primary\" style=\"float: right;margin-left: 10px\" icon=\"el-icon-download\" @click=\"clearModel\">清空记录</el-button>\n      <el-button type=\"primary\" style=\"float: right\" icon=\"el-icon-download\" @click=\"downLoadModel\">一键下载模型</el-button>\n    </div>\n\n    <el-divider content-position=\"left\">模型检测结果</el-divider>\n\n    <div v-show=\"imglist.length\" class=\"new_img\">\n      <img v-for=\"(item,index) in imglist\" :key=\"index\" :src=\"item.url\" title=\"预览\" alt=\"预览\" @click=\"handlePictureCardPreview(item)\">\n    </div>\n  </div>\n</template>\n\n<script>\nimport deviceMixin from '@/mixins/device'\nimport { getToken } from '@/utils/auth'\n\nexport default {\n  name: 'Photo',\n  mixins: [deviceMixin],\n  data() {\n    return {\n      dialogImg: {},\n      dialogVisible: false,\n      imglist: [],\n      token: ''\n    }\n  },\n  mounted() {\n    this.token = getToken()\n  },\n  methods: {\n    handleRemove: function(file, fileList) {\n    },\n    handlePictureCardPreview(file) {\n      this.dialogImg = file\n      this.dialogVisible = true\n    },\n    handleSuccess(res, file, filelist) {\n      res.url = '/dev-api' + res.url\n      this.imglist.push(res)\n      console.log(this.imglist)\n    },\n    openImg() {\n      window.open(this.dialogImg.url)\n    },\n    clearModel() {\n      this.$refs.upload.clearFiles()\n      this.imglist = []\n    },\n    downLoadModel() {\n      for (let i = 0; i < this.imglist.length; i++) {\n        const urlname = this.imglist[i].url.split('/')\n        const filename = urlname[urlname.length - 1]\n        const url = 'http://127.0.0.1:3001' + this.imglist[i].url.split(process.env.VUE_APP_BASE_API).join('')\n        this.downloadPic(url, filename)\n      }\n    },\n    /* 图片的下载*/\n    downloadPic(url, filename) {\n      const imgsrc = url\n      const image = new Image()\n      // 解决跨域canvas污染问题\n      image.setAttribute('crossOrigin', 'anonymous')\n      image.onload = function() {\n        const canvas = document.createElement('canvas')\n        canvas.width = image.width\n        canvas.height = image.height\n        const context = canvas.getContext('2d')\n        context.drawImage(image, 0, 0, image.width, image.height)\n        const url = canvas.toDataURL('image/png') // 得到图片的base64编码数据\n        const a = document.createElement('a')\n        a.download = filename\n        a.href = url\n        a.click()\n      }\n      image.src = imgsrc\n    }\n\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.original_img{\n\n}\n\n.new_img{\n  img {\n    width: 146px;\n    height: 146px;\n    margin: 0px 4px;\n    &:hover {\n      cursor: pointer;\n      transform: scale(1.1);\n      transition: 0.5s;\n    }\n  }\n}\n\n</style>\n"]}]}