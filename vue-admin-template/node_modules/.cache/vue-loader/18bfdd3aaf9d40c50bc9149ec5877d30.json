{"remainingRequest":"E:\\aproject\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\aproject\\vue-admin-template\\src\\views\\video\\index.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\aproject\\vue-admin-template\\src\\views\\video\\index.vue","mtime":1683208431700},{"path":"E:\\aproject\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1680534835386},{"path":"E:\\aproject\\vue-admin-template\\node_modules\\babel-loader\\lib\\index.js","mtime":1680534836652},{"path":"E:\\aproject\\vue-admin-template\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1680534835386},{"path":"E:\\aproject\\vue-admin-template\\node_modules\\vue-loader\\lib\\index.js","mtime":1680534837350}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBkZXZpY2VNaXhpbiBmcm9tICdAL21peGlucy9kZXZpY2UnCmltcG9ydCBhcGlCYXNlVXJsIGZyb20gJ0AvbWl4aW5zL2FwaUJhc2VVcmwnCmltcG9ydCB7IGdldFRva2VuIH0gZnJvbSAnQC91dGlscy9hdXRoJwppbXBvcnQgeyBkb3duVmlkZW8gfSBmcm9tICdAL3V0aWxzL2Rvd25sb2FkJwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1ZpZGVvJywKICBtaXhpbnM6IFtkZXZpY2VNaXhpbiwgYXBpQmFzZVVybF0sCiAgaXNjaGVja2luZzogZmFsc2UsIC8vIOato+WcqOS4iuS8oOajgOa1iwogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkaWFsb2dJbWFnZVVybDogJycsCiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICB2aWRlb1VybDogJycsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBwcm9ncmVzc1N0YXRlOiBbewogICAgICAgIGlkOiAxLAogICAgICAgIHBlcmNlbnRhZ2U6IDMwCiAgICAgIH0sIHsKICAgICAgICBpZDogMiwKICAgICAgICBwZXJjZW50YWdlOiA1MAogICAgICB9XSwKICAgICAgdG9rZW46ICcnCiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy50b2tlbiA9IGdldFRva2VuKCkKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIGdldFJhbmRvbTEoKSB7CiAgICAvLyAgIHJldHVybiBNYXRoLmZsb29yKChNYXRoLnJhbmRvbSgpICogMTApICsgMTEpCiAgICAvLyB9LAogICAgLy8gZ2V0UmFuZG9tMigpIHsKICAgIC8vICAgcmV0dXJuIE1hdGguZmxvb3IoKE1hdGgucmFuZG9tKCkgKiAyKSArIDQwKQogICAgLy8gfSwKICAgIGNsZWFyVmlkZW8oKSB7CiAgICAgIHRoaXMuJHJlZnMudXBsb2FkLmNsZWFyRmlsZXMoKQogICAgICB0aGlzLmltZ2xpc3QgPSBbXQogICAgfSwKICAgIGhhbmRsZUJlZm9yZVVwbG9hZChmaWxlKSB7CiAgICAgIGNvbnN0IHsgdHlwZSB9ID0gZmlsZQogICAgICBpZiAoL3ZpZGVvLy50ZXN0KHR5cGUpKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICBtZXNzYWdlOiAn6KeG6aKR5qOA5rWL5LitLi4u6K+356iN5YCZJywKICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJwogICAgICAgIH0pCiAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZQogICAgICAgIHJldHVybiB0cnVlCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICBtZXNzYWdlOiAn5Y+q6IO95LiK5Lyg6KeG6aKRJywKICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICAgIH0pCiAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgIH0KICAgIH0sCiAgICBoYW5kbGVQaWN0dXJlQ2FyZFByZXZpZXcoZmlsZSkgewogICAgICB0aGlzLmRpYWxvZ0ltYWdlVXJsID0gZmlsZS51cmwKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZQogICAgfSwKICAgIGhhbmRsZVN1Y2Nlc3MocmVzLCBmaWxlKSB7CiAgICAgIHRoaXMudmlkZW9VcmwgPSBwcm9jZXNzLmVudi5WVUVfQVBQX0JBU0VfQVBJICsgcmVzLnVybAogICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICBtZXNzYWdlOiAn6KeG6aKR5qOA5rWL5oiQ5YqfJywKICAgICAgICB0eXBlOiAnc3VjY2VzcycKICAgICAgfSkKICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgIH0sCiAgICBzdWJQcm9ncmVzcyhpdGVtKSB7CiAgICAgIGlmIChpdGVtLnBlcmNlbnRhZ2UgPD0gMCkgcmV0dXJuCiAgICAgIGl0ZW0ucGVyY2VudGFnZSAtPSAxMAogICAgfSwKICAgIGFkZFByb2dyZXNzKGl0ZW0pIHsKICAgICAgaWYgKGl0ZW0ucGVyY2VudGFnZSA+PSAxMDApIHJldHVybgogICAgICBpdGVtLnBlcmNlbnRhZ2UgKz0gMTAKICAgIH0sCiAgICBkb3duVmlkZW8odXJsKSB7CiAgICAgIGRvd25WaWRlbyh1cmwpCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/video","sourcesContent":["<template>\n  <div class=\"video_root\">\n    <!-- 左侧原视频   -->\n    <el-card v-if=\"videoUrl==''\" class=\"original_video\">\n      <el-skeleton :loading=\"loading\" animated>\n        <template slot=\"template\">\n          <el-skeleton-item\n            variant=\"image\"\n            :style=\"{width: '100%', height:(screenHeight-50)+'px'}\"\n          />\n        </template>\n        <template>\n          <el-upload\n            ref=\"upload\"\n            class=\"avatar-uploader\"\n            :action=\"getBaseUrl()+'/uploadvideo'\"\n            :show-file-list=\"false\"\n            :on-success=\"handleSuccess\"\n            :before-upload=\"handleBeforeUpload\"\n            :headers=\"{token:token}\"\n          >\n            <i class=\"el-icon-plus avatar-uploader-icon\" />\n          </el-upload>\n        </template>\n      </el-skeleton>\n    </el-card>\n    <!--    左侧模型-->\n    <el-card v-else class=\"new_video\">\n      <video :src=\"videoUrl\" autoplay controls=\"controls\" crossOrigin=\"Anonymous\">\n        您的浏览器不支持 video 标签。\n      </video>\n    </el-card>\n    <!--    控制台-->\n    <el-card class=\"contronal\" :style=\"{height:screenHeight+'px'}\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span style=\"font-size: 20px;font-weight: 700\">控制台</span>\n        <button style=\"float: right; padding: 5px\" class=\"choose_button\">确认设置</button>\n      </div>\n      <el-card class=\"showdata\">\n        <div><b>检测用时：</b>{{ videoUrl?15.0:0 }} s</div>\n        <div><b>目标数：</b>{{ videoUrl?89:0 }}</div>\n        <div><b>检测速度：</b>{{ videoUrl?41:0 }} FPS</div>\n      </el-card>\n      <div class=\"showbtns\">\n        <div class=\"progress_msg\">\n          <div class=\"process_left\">\n            <div>NMS-IOU</div>\n            <div>Confidence</div>\n<!--            <div>帧间延迟</div>-->\n          </div>\n          <div class=\"process_center\">\n            <el-progress v-for=\"(item,index) in progressState\" :key=\"index\" :text-inside=\"true\" :stroke-width=\"20\" :percentage=\"item.percentage\" status=\"exception\" />\n          </div>\n          <div class=\"process_right\">\n            <div v-for=\"(item,index) in progressState\" :key=\"index\" class=\"buttons\">\n              <span @click=\"subProgress(item)\">-</span>\n              <span @click=\"addProgress(item)\">+</span>\n            </div>\n          </div>\n        </div>\n        <div class=\"other_choose\">\n          <div class=\"choose_button el-icon-delete-solid\" @click=\"clearVideo\">视频缓存清空</div>\n          <div class=\"choose_button el-icon-download\" @click=\"videoUrl&&downVideo(videoUrl)\">检测视频下载</div>\n        </div>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport deviceMixin from '@/mixins/device'\nimport apiBaseUrl from '@/mixins/apiBaseUrl'\nimport { getToken } from '@/utils/auth'\nimport { downVideo } from '@/utils/download'\nexport default {\n  name: 'Video',\n  mixins: [deviceMixin, apiBaseUrl],\n  ischecking: false, // 正在上传检测\n  data() {\n    return {\n      dialogImageUrl: '',\n      dialogVisible: false,\n      videoUrl: '',\n      loading: false,\n      progressState: [{\n        id: 1,\n        percentage: 30\n      }, {\n        id: 2,\n        percentage: 50\n      }],\n      token: ''\n    }\n  },\n  mounted() {\n    this.token = getToken()\n  },\n  methods: {\n    // getRandom1() {\n    //   return Math.floor((Math.random() * 10) + 11)\n    // },\n    // getRandom2() {\n    //   return Math.floor((Math.random() * 2) + 40)\n    // },\n    clearVideo() {\n      this.$refs.upload.clearFiles()\n      this.imglist = []\n    },\n    handleBeforeUpload(file) {\n      const { type } = file\n      if (/video/.test(type)) {\n        this.$message({\n          message: '视频检测中...请稍候',\n          type: 'success'\n        })\n        this.loading = true\n        return true\n      } else {\n        this.$message({\n          message: '只能上传视频',\n          type: 'warning'\n        })\n        return false\n      }\n    },\n    handlePictureCardPreview(file) {\n      this.dialogImageUrl = file.url\n      this.dialogVisible = true\n    },\n    handleSuccess(res, file) {\n      this.videoUrl = process.env.VUE_APP_BASE_API + res.url\n      this.$message({\n        message: '视频检测成功',\n        type: 'success'\n      })\n      this.loading = false\n    },\n    subProgress(item) {\n      if (item.percentage <= 0) return\n      item.percentage -= 10\n    },\n    addProgress(item) {\n      if (item.percentage >= 100) return\n      item.percentage += 10\n    },\n    downVideo(url) {\n      downVideo(url)\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n.avatar-uploader-icon {\n  border: 1px dashed #d9d9d9;\n  font-size: 28px;\n  color: #8c939d;\n  width: 178px;\n  height: 178px;\n  line-height: 178px;\n  text-align: center;\n}\n .avatar-uploader-icon:hover {\n  border-color: #409EFF;\n}\n\n .video_root{\n   display: flex;\n   width: 100%;\n   .original_video{\n     flex: 1;\n   }\n   .new_video{\n     flex: 1;\n   }\n   .contronal{\n     width: 400px;\n     height: 100%;\n     overflow: auto;\n     margin-left: 10px;\n     .showdata{\n       border-radius: 10px;\n       margin-bottom: 20px;\n       background-color: #8ee8f8;\n       box-shadow: 1px 5px 5px 2px #20a0ff;\n       div {\n         width: 100%;\n         margin: 6px 0;\n       }\n     }\n     .showbtns{\n       .progress_msg{\n         width: 100%;\n         display: flex;\n         .process_left{\n           width: 80px;\n           font-size: 14px;\n           div {\n             margin: 6px 0;\n             line-height: 20px;\n           }\n         }\n         .process_center{\n           flex: 1;\n         }\n         .process_right{\n           width: 84px;\n           .buttons{\n             box-sizing: border-box;\n             line-height: 20px;\n             margin: 6px 0;\n             span {\n               display: inline-block;\n               margin: 0 5px;\n               text-align: center;\n               width: 30px;\n               cursor: pointer;\n               background-color: #0173e7;\n               border-radius: 5px;\n               color: #fff;\n               &:hover {\n                 background-color: #1687ff;\n               }\n             }\n           }\n         }\n       }\n\n       .other_choose{\n         margin: 10px 0px;\n         display: flex;\n         flex-wrap: wrap;\n         .choose_button{\n           margin:20px 30px 0px 0px;\n         }\n       }\n\n       .el-progress{\n         margin: 6px;\n       }\n     }\n   }\n }\n video{\n   width: 100%;\n }\n</style>\n"]}]}